import fs from 'fs';
import path from 'path';

const ignoredFolders = ['node_modules', '.git', 'dist', 'build', '.next', '.vercel', '.turbo'];

export const generateFileTree = (dir = '.', prefix = '') => {
  let tree = '';

  const files = fs.readdirSync(dir).filter(file => !ignoredFolders.includes(file));

  files.forEach((file, index) => {
    const filePath = path.join(dir, file);
    const isLast = index === files.length - 1;
    const stats = fs.statSync(filePath);

    if (stats.isDirectory()) {
      tree += `${prefix}${isLast ? '└── ' : '├── '}📁 ${file}\n`;
      tree += generateFileTree(filePath, prefix + (isLast ? '    ' : '│   '));
    } else {
      tree += `${prefix}${isLast ? '└── ' : '├── '}📄 ${file}\n`;
    }
  });

  return tree;
};
