#!/usr/bin/env node

import inquirer from 'inquirer';
import chalk from 'chalk';
import figlet from 'figlet';
import fs from 'fs';
import { execSync } from 'child_process';
import { generateREADME } from './readme_generation.js';
import { generateChangelog } from './changelog_generation.js';
import { questions } from './questions.js';

// Mostrar título con Figlet y Chalk
console.log(
    chalk.blue(
        figlet.textSync('README GENERATOR', { horizontalLayout: 'full' })
    )
);

const run = async () => {
    try {
        // Preguntar todo al usuario
        const answers = await inquirer.prompt(questions);

        // Generar el README.md
        const readmeContent = generateREADME(answers);
        fs.writeFileSync('README.md', readmeContent);
        console.log(chalk.green('✅ README.md generado exitosamente!'));

        // Generar el CHANGELOG.md si el usuario lo desea
        if (answers.generateChangelog) {
            const changelogContent = generateChangelog();
            fs.writeFileSync('CHANGELOG.md', changelogContent);
            console.log(chalk.green('✅ CHANGELOG.md generado exitosamente!'));
        }

        // Inicializar git si el usuario lo desea
        if (answers.initializeGit) {
            execSync('git init');
            console.log(chalk.green('✅ Repositorio git inicializado!'));
        }

    } catch (error) {
        console.error(chalk.red('❌ Hubo un error al generar los archivos:'), error);
    }
};

run();
